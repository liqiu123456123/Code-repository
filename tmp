import json
import os

def split_jsonl_to_n_files(file_path, output_dir, n):
    # 读取输入文件中的所有行
    with open(file_path, 'r', encoding='utf-8') as file:
        lines = file.readlines()
    
    # 计算每个输出文件应包含的行数
    total_lines = len(lines)
    lines_per_file = total_lines // n
    remainder = total_lines % n

    # 确保输出目录存在
    if not os.path.exists(output_dir):
        os.makedirs(output_dir)

    start = 0
    for i in range(n):
        # 计算当前文件的结束行
        end = start + lines_per_file + (1 if i < remainder else 0)
        
        # 生成输出文件路径
        output_file_path = os.path.join(output_dir, f"split_{i}.jsonl")
        
        # 写入当前文件的行
        with open(output_file_path, 'w', encoding='utf-8') as output_file:
            for line in lines[start:end]:
                output_file.write(line)
        
        # 更新开始行
        start = end

# 示例调用
split_jsonl_to_n_files('data.jsonl', 'output_directory', 10)
